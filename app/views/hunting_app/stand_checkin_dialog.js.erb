(function() {
  var activePage = $.mobile.pageContainer.pagecontainer("getActivePage");
  var dialog = $('#huntingLocationPopupDialog', activePage);
  dialog.html('<%= j render(:partial => 'stand_checkin_dialog')%>').trigger("create");
  var checkInForm = dialog.find('#checkin-form');
  //checkInForm.find('input[name="position_longitude"]').val(hunting_location.id);
  //checkInForm.find('input[name="position_latitude"]').val(hunting_location.id);
  var checkinWarning = dialog.find('#checkin-submit-warn');
  if (checkinWarning.length > 0) {
    dialog.find('#checkin-submit-warn').click(
      function() {
        var activePage = $.mobile.pageContainer.pagecontainer("getActivePage");
        var dialog = $('#huntingLocationPopupDialog', activePage);
        $('#checkin-warning', activePage).hide();
        $('#checkin-form', activePage).show();
        dialog.popup("reposition", { positionTo: 'window' });
      }
    );
    $('#checkin-form', activePage).hide();
  }
  dialog.popup("open");
})();
